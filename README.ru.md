# Шаблон скрипта развертывания приложения (deployment).

С использованием инструмента  Deployer (https://deployer.org/).

## Установка 

Для установки скрипта на сервер, на который будет происходить развертывание, 
скопируйте файлы данного репозитория в папку проекта на сервере. Например, `/var/www/example.com`.

Затем в консоли запустите установщик Deployer:
```
cd /var/www/example.com
./deployer-install.sh 
```
В файле `deploy.php` настройте сценарий развертывания и пути к репозиторию. Дополнительную информацию по конфигурации можно прочитать в официальной документации Deployer (https://deployer.org/docs).

## Доступ к репозиторию

Если требуется SSH-ключ для доступа к репозиторию проекта, то сгенерировать его можно командой `ssh-keygen`. Сгенерированный публичный ключ необходимо внести в настройки системы доступа к репозиторию.

## Запуск развертывания
```
dep deploy
```
или с указанием целевого сценария развертывания (например: testing, staging, production).

```
dep deploy staging
```
Перезагрузка веб-сервера не требуется, т.к. процесс развертывания происходит путем замены символических ссылок.

## Структура директорий

При развертывании в корневой директории проекта создаются три директории:

- `current` — символическая ссылка на директорию последнего успешного релиза, текущая версия приложения, она должна быть указана в настройке виртуального хоста веб-сервера. Например, `/var/www/example.com/current/public`;
- `releases` — директория с релизами. Хранятся только последние 4 релиза (меняется в конфигурации);
- `shared` — директория, в которой находятся все "общие" файлы, относящиеся ко всем релизам одновременно (загруженные файлы, локальная конфигурация). 


## Open Source

Copyright (c) 2017 Евгений Дементьев.
BSD 3-clause License (https://opensource.org/licenses/BSD-3-Clause).
